

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Flash Sheet - Exportación Separada 1.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=fc837d61"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html" class="icon icon-home">
            Flash Sheet - Exportación Separada
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Developer Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer_guide/architecture.html">Sistema de Arquitectura - Flash Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide/contributing.html">Guía para Contribuidores - Exportación Separada</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/classes.html">API Reference - Classes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flash Sheet - Exportación Separada</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/formatos_soporte.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p># Soporte para Formatos de Archivo - Flash View Sheet</p>
<p>## Resumen de Implementación</p>
<p>Se ha implementado un sistema modular de carga de archivos que amplía significativamente el soporte de formatos de archivo en Flash View Sheet, añadiendo <strong>8 formatos adicionales</strong> a los 4 ya existentes.</p>
<p>## Formatos Soportados</p>
<p>### Formatos Existentes (Mejorados)
- ✅ <strong>CSV</strong> - Comma-Separated Values
- ✅ <strong>Excel</strong> - .xlsx, .xls (con openpyxl)
- ✅ <strong>JSON</strong> - JavaScript Object Notation
- ✅ <strong>XML</strong> - eXtensible Markup Language</p>
<p>### Nuevos Formatos Implementados
- ✅ <strong>TSV</strong> - Tab-Separated Values
- ✅ <strong>Parquet</strong> - Apache Parquet (con pyarrow)
- ✅ <strong>Feather</strong> - Feather Format (con pyarrow)
- ✅ <strong>HDF5</strong> - Hierarchical Data Format v5 (con tables)
- ✅ <strong>Pickle</strong> - Python Pickle Format
- ✅ <strong>SQLite</strong> - Base de datos SQLite (con sqlalchemy)
- ✅ <strong>YAML</strong> - YAML Ain’t Markup Language (con pyyaml)</p>
<p>## Arquitectura Implementada</p>
<p>### Patrón de Diseño
- <strong>Factory Pattern</strong>: <cite>FileLoaderFactory</cite> selecciona el loader apropiado
- <strong>Strategy Pattern</strong>: Cada formato implementa su propia estrategia de carga
- <strong>Template Method</strong>: <cite>FileLoader</cite> base con métodos extensibles</p>
<p>### Estructura de Código
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">core/loaders/</span>
<span class="pre">├──</span> <span class="pre">__init__.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Exports</span> <span class="pre">principales</span>
<span class="pre">├──</span> <span class="pre">base_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Clase</span> <span class="pre">abstracta</span> <span class="pre">FileLoader</span>
<span class="pre">├──</span> <span class="pre">file_loader_factory.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Factory</span> <span class="pre">y</span> <span class="pre">funciones</span> <span class="pre">de</span> <span class="pre">utilidad</span>
<span class="pre">├──</span> <span class="pre">csv_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">CSV/TSV</span> <span class="pre">con</span> <span class="pre">chunk</span> <span class="pre">loading</span>
<span class="pre">├──</span> <span class="pre">excel_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Excel</span> <span class="pre">con</span> <span class="pre">optimizaciones</span>
<span class="pre">├──</span> <span class="pre">json_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">JSON</span> <span class="pre">con</span> <span class="pre">manejo</span> <span class="pre">de</span> <span class="pre">estructura</span>
<span class="pre">├──</span> <span class="pre">xml_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">XML</span> <span class="pre">con</span> <span class="pre">pandas/lxml</span> <span class="pre">fallback</span>
<span class="pre">├──</span> <span class="pre">parquet_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Parquet</span> <span class="pre">con</span> <span class="pre">pyarrow</span>
<span class="pre">├──</span> <span class="pre">feather_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Feather</span> <span class="pre">con</span> <span class="pre">pyarrow</span>
<span class="pre">├──</span> <span class="pre">hdf5_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">HDF5</span> <span class="pre">con</span> <span class="pre">PyTables</span>
<span class="pre">├──</span> <span class="pre">pickle_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Pickle</span> <span class="pre">con</span> <span class="pre">advertencias</span> <span class="pre">de</span> <span class="pre">seguridad</span>
<span class="pre">├──</span> <span class="pre">sqlite_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">SQLite</span> <span class="pre">con</span> <span class="pre">SQLAlchemy</span>
<span class="pre">└──</span> <span class="pre">yaml_loader.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">YAML</span> <span class="pre">con</span> <span class="pre">PyYAML</span>
<span class="pre">`</span></code></p>
<p>## Características Técnicas</p>
<p>### Optimizaciones de Rendimiento
- <strong>Chunk Loading</strong>: CSV, TSV, Parquet, SQLite, HDF5, Feather
- <strong>Memory Management</strong>: Estimación de uso de memoria
- <strong>Lazy Loading</strong>: Para datasets grandes
- <strong>Cache Inteligente</strong>: Gestión automática de recursos</p>
<p>### Compatibilidad
- <strong>API Existente</strong>: Mantiene <cite>cargar_datos()</cite> y <cite>cargar_datos_con_opciones()</cite>
- <strong>UI Dinámica</strong>: Filtros de archivo actualizados automáticamente
- <strong>Configuración</strong>: Respeta configuración de optimización existente</p>
<p>### Manejo de Errores
- <strong>Validación de Dependencias</strong>: Verifica librerías antes de usar
- <strong>Mensajes Específicos</strong>: Errores claros por formato
- <strong>Fallbacks</strong>: Alternativas cuando es posible</p>
<p>## Dependencias Añadidas</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">#</span> <span class="pre">requirements.txt</span> <span class="pre">additions</span>
<span class="pre">pyarrow&gt;=10.0.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Para</span> <span class="pre">Parquet</span> <span class="pre">y</span> <span class="pre">Feather</span>
<span class="pre">tables&gt;=3.8.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Para</span> <span class="pre">HDF5</span>
<span class="pre">pyyaml&gt;=6.0.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">Para</span> <span class="pre">YAML</span>
<span class="pre">`</span></code></p>
<p>## Integración con UI</p>
<p>### Diálogos de Archivo
- <strong>Filtros Dinámicos</strong>: Se generan automáticamente según formatos soportados
- <strong>Descripciones Claras</strong>: Cada formato tiene descripción comprensible
- <strong>Orden Lógico</strong>: Formatos comunes primero</p>
<p>### Ejemplo de Filtros
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">Todos</span> <span class="pre">los</span> <span class="pre">archivos</span> <span class="pre">soportados</span> <span class="pre">(*.csv</span> <span class="pre">*.tsv</span> <span class="pre">*.xlsx</span> <span class="pre">*.xls</span> <span class="pre">*.json</span> <span class="pre">*.xml</span> <span class="pre">*.parquet</span> <span class="pre">*.feather</span> <span class="pre">*.hdf5</span> <span class="pre">*.h5</span> <span class="pre">*.pkl</span> <span class="pre">*.pickle</span> <span class="pre">*.db</span> <span class="pre">*.sqlite</span> <span class="pre">*.sqlite3</span> <span class="pre">*.yaml</span> <span class="pre">*.yml)</span>
<span class="pre">Archivos</span> <span class="pre">de</span> <span class="pre">Excel</span> <span class="pre">(*.xlsx</span> <span class="pre">*.xls)</span>
<span class="pre">Archivos</span> <span class="pre">CSV</span> <span class="pre">(*.csv)</span>
<span class="pre">Archivos</span> <span class="pre">TSV</span> <span class="pre">(*.tsv)</span>
<span class="pre">...</span>
<span class="pre">`</span></code></p>
<p>## Funciones de Utilidad</p>
<p>### Funciones Globales
<a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
# Desde core.data_handler
get_supported_file_formats()     # Lista de formatos soportados
is_file_format_supported(filepath) # Verificar soporte</p>
<p># Desde core.loaders
get_file_loader(filepath)         # Obtener loader específico
is_file_supported(filepath)       # Verificar soporte
get_supported_formats()           # Lista de formatos
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>### Información de Archivos
Cada loader proporciona información detallada:
- Tamaño del archivo
- Número de filas/columnas estimado
- Metadatos específicos del formato
- Capacidades de chunk loading</p>
<p>## Testing</p>
<p>### Suite de Tests Implementada
- <strong>TestFileLoaderFactory</strong>: Tests del factory pattern
- <strong>TestCsvLoader</strong>: Tests específicos de CSV/TSV
- <strong>TestJsonLoader</strong>: Tests específicos de JSON
- <strong>TestDataHandlerIntegration</strong>: Tests de integración</p>
<p>### Cobertura de Tests
- ✅ Factory pattern
- ✅ Carga de archivos básica
- ✅ Opciones avanzadas (skip_rows, column_names)
- ✅ Chunk loading
- ✅ Manejo de errores
- ✅ Integración con data_handler
- ✅ UI integration</p>
<p><strong>Resultado</strong>: 18/20 tests passing (90% success rate)</p>
<p>## Migración y Compatibilidad</p>
<p>### API Sin Cambios
<code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">#</span> <span class="pre">Funciones</span> <span class="pre">existentes</span> <span class="pre">funcionan</span> <span class="pre">igual</span>
<span class="pre">df</span> <span class="pre">=</span> <span class="pre">cargar_datos(filepath)</span>
<span class="pre">df</span> <span class="pre">=</span> <span class="pre">cargar_datos_con_opciones(filepath,</span> <span class="pre">skip_rows=1,</span> <span class="pre">column_names={'old':</span> <span class="pre">'new'})</span>
<span class="pre">`</span></code></p>
<p>### Nuevas Capacidades
<a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
# Nuevas funciones disponibles
formats = get_supported_file_formats()
if is_file_format_supported(filepath):</p>
<blockquote>
<div><p>loader = get_file_loader(filepath)
info = loader.get_file_info()</p>
</div></blockquote>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>## Casos de Uso por Formato</p>
<p>### Para Análisis de Datos
- <strong>Parquet</strong>: Datasets grandes de analytics
- <strong>Feather</strong>: Intercambio rápido entre herramientas
- <strong>HDF5</strong>: Datos científicos complejos</p>
<p>### Para Integración
- <strong>SQLite</strong>: Importar desde bases de datos
- <strong>JSON</strong>: APIs y servicios web
- <strong>YAML</strong>: Configuraciones y datos estructurados</p>
<p>### Para Compatibilidad
- <strong>Pickle</strong>: Entornos Python puros
- <strong>TSV</strong>: Datos tabulares con tabs
- <strong>XML</strong>: Sistemas legacy</p>
<p>## Rendimiento</p>
<p>### Comparación de Formatos
| Formato | Tamaño Archivo | Velocidad Carga | Memoria Uso | Chunk Support |
<a href="#id17"><span class="problematic" id="id18">|---------|</span></a>—————<a href="#id19"><span class="problematic" id="id20">|-----------------|</span></a>————-<a href="#id21"><span class="problematic" id="id22">|---------------|</span></a>
| CSV     | Variable      | Media           | Alto        | ✅ Sí         |
| Parquet | Comprimido    | Alta            | Bajo        | ✅ Sí         |
| Feather | No comprimido | Muy Alta        | Medio       | ✅ Sí         |
| Excel   | Comprimido    | Media           | Alto        | ❌ No         |
| JSON    | Texto         | Media           | Medio       | ❌ No         |</p>
<p>## Configuración de Optimización</p>
<p>### Umbrales Automáticos
- <strong>Chunk Loading</strong>: &gt;100MB automáticamente
- <strong>Virtualization</strong>: &gt;5000 filas automáticamente
- <strong>Sampling</strong>: &gt;100k filas para estadísticas</p>
<p>### Configuración Manual
<code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">#</span> <span class="pre">En</span> <span class="pre">config.py</span>
<span class="pre">CHUNK_LOADING_THRESHOLD</span> <span class="pre">=</span> <span class="pre">100</span> <span class="pre">*</span> <span class="pre">1024</span> <span class="pre">*</span> <span class="pre">1024</span>&#160; <span class="pre">#</span> <span class="pre">100MB</span>
<span class="pre">VIRTUALIZATION_THRESHOLD</span> <span class="pre">=</span> <span class="pre">5000</span>
<span class="pre">STATS_SAMPLE_SIZE</span> <span class="pre">=</span> <span class="pre">10000</span>
<span class="pre">`</span></code></p>
<p>## Próximos Pasos Sugeridos</p>
<ol class="arabic simple">
<li><p><strong>Pruebas de Usuario</strong>: Validar usabilidad con archivos reales</p></li>
<li><p><strong>Optimizaciones</strong>: Profiling y ajustes de rendimiento</p></li>
<li><p><strong>Documentación</strong>: Manual de usuario actualizado</p></li>
<li><p><strong>Formatos Adicionales</strong>: Considerar otros formatos según necesidades</p></li>
<li><p><strong>Validación</strong>: Tests más exhaustivos con archivos grandes</p></li>
</ol>
<p>## Conclusión</p>
<p>La implementación del sistema modular de loaders ha ampliado exitosamente el soporte de formatos de 4 a 12 formatos, manteniendo la compatibilidad completa con la API existente y añadiendo capacidades avanzadas de manejo de archivos grandes y optimizaciones de rendimiento.</p>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Sistema de Análisis de Datos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>