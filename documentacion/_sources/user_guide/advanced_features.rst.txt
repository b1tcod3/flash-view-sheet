Guía de Características Avanzadas
================================

Esta guía cubre la funcionalidad avanzada en Flash Sheet, incluyendo carga de carpetas, uniones de datos, exportaciones separadas y tablas pivote.

Carga de Carpetas
-----------------

Carga de Múltiples Archivos
~~~~~~~~~~~~~~~~~~~~~~~~~~~

La carga de carpetas permite consolidar datos de múltiples archivos Excel en un directorio:

1. Haz clic en **"Archivo"** → **"Cargar Carpeta..."**
2. Selecciona la carpeta que contiene tus archivos Excel
3. Elige archivos a incluir en la consolidación
4. Configura alineación de columnas (automática o manual)
5. Revisa la preview y consolida

   .. figure:: ../_static/screenshots/folder_loading_dialog.png
      :alt: Diálogo de carga de carpeta
      :width: 600px

      Interfaz de carga de carpeta mostrando selección de archivos y alineación de columnas.

Formatos Soportados
~~~~~~~~~~~~~~~~~~~

- **Archivos Excel**: formatos .xlsx y .xls
- **Búsqueda Recursiva**: Incluir archivos en subdirectorios
- **Filtrado de Archivos**: Seleccionar archivos específicos o patrones
- **Preview de Metadata**: Ver información de archivos antes de cargar

Alineación de Columnas
~~~~~~~~~~~~~~~~~~~~~~

- **Alineación Automática**: Hacer coincidir columnas por posición o nombre
- **Alineación Manual**: Arrastrar y soltar para realinear columnas
- **Renombrado de Columnas**: Personalizar nombres de columnas consolidadas
- **Manejo de Tipos**: Gestionar diferentes tipos de datos entre archivos

Uniones de Datos (Fusión)
-------------------------

Operaciones de Unión
~~~~~~~~~~~~~~~~~~~~

Flash Sheet soporta operaciones de unión tipo SQL para combinar datasets:

Tipos de Uniones
^^^^^^^^^^^^^^^^

- **Unión Interna**: Solo filas coincidentes de ambos datasets
- **Unión Izquierda**: Todas las filas del dataset izquierdo + coincidencias del derecho
- **Unión Derecha**: Todas las filas del dataset derecho + coincidencias del izquierdo
- **Unión Cruzada**: Producto cartesiano de ambos datasets

Configuración de Unión
^^^^^^^^^^^^^^^^^^^^^^

1. Carga el dataset primario
2. Haz clic en **"Datos"** → **"Unir Datos..."**
3. Carga el dataset secundario
4. Selecciona tipo de unión y columnas coincidentes
5. Configura opciones adicionales
6. Preview y ejecuta la unión

   .. figure:: ../_static/screenshots/join_dialog.png
      :alt: Diálogo de configuración de unión de datos
      :width: 600px

      Diálogo de unión mostrando selección de dataset, tipo de unión y mapeo de columnas.

Opciones Avanzadas de Unión
^^^^^^^^^^^^^^^^^^^^^^^^^^^

- **Múltiples Claves de Unión**: Unir en múltiples combinaciones de columnas
- **Condiciones de Unión**: Lógica de unión más allá de igualdad
- **Manejo de Sufijos**: Gestionar nombres de columna duplicados
- **Manejo de Nulos**: Controlar cómo los valores nulos afectan las uniones

Exportaciones Separadas
-----------------------

Exportaciones Basadas en Plantillas
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Las exportaciones separadas permiten dividir datos en múltiples archivos Excel usando plantillas:

1. Prepara tu plantilla Excel con formato
2. Carga el dataset con columna de separación
3. Haz clic en **"Separar"** → **"Exportar Datos Separados..."**
4. Configura columna de separación y plantilla
5. Establece opciones de salida y exporta

Requisitos de Plantilla
~~~~~~~~~~~~~~~~~~~~~~~

- **Formato Excel**: archivos .xlsx (no .xls)
- **Fila de Encabezado**: Nombres de columna en primera fila
- **Área de Datos**: Área designada para inserción de datos
- **Formato**: Preservar fuentes, colores, fórmulas

Configuración de Exportación
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- **Columna de Separación**: Columna que contiene identificadores de grupo
- **Nomenclatura de Archivos**: Plantillas para nombres de archivos de salida
- **Carpeta de Destino**: Carpeta destino para archivos generados
- **Mapeo de Columnas**: Mapear columnas del dataset a columnas de plantilla

Tablas Pivote
-------------
Creando Tablas Pivote
~~~~~~~~~~~~~~~~~~~~~~

Las tablas pivote proporcionan resumen dinámico de datos:

1. Carga tu dataset
2. Haz clic en **"Datos"** → **"Tabla Pivote..."**
3. Selecciona campos de fila, columna y valor
4. Configura funciones de agregación
5. Genera la tabla pivote

   .. figure:: ../_static/screenshots/pivot_table_dialog.png
      :alt: Diálogo de configuración de tabla pivote
      :width: 600px

      Configuración de tabla pivote mostrando selección de campos y opciones de agregación.

Componentes de Pivote
~~~~~~~~~~~~~~~~~~~~~

- **Campos de Fila**: Categorías para agrupamiento de filas
- **Campos de Columna**: Categorías para agrupamiento de columnas
- **Campos de Valor**: Campos numéricos a agregar
- **Campos de Filtro**: Campos para filtrar toda la tabla pivote

Funciones de Agregación
~~~~~~~~~~~~~~~~~~~~~~~

- **Suma**: Total de valores
- **Conteo**: Número de elementos
- **Promedio**: Media de valores
- **Mín/Máx**: Valor mínimo o máximo
- **Desviación Estándar**: Dispersión estadística
- **Funciones Personalizadas**: Agregaciones definidas por usuario

Características Avanzadas de Pivote
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- **Consolidación Múltiple**: Combinar múltiples campos de valor
- **Campos Calculados**: Agregar columnas computadas
- **Agrupamiento**: Agrupar fechas, números o valores de texto
- **Drill-down**: Expandir detalles de pivote

Ejemplos Detallados y Casos de Uso Empresariales
================================================

Esta sección proporciona ejemplos prácticos paso a paso y escenarios empresariales reales para implementar la exportación separada en diferentes situaciones. Cada ejemplo incluye:

- **Datos de muestra** para practicar
- **Configuración específica** recomendada
- **Plantillas Excel** de ejemplo
- **Resultados esperados** y métricas
- **Consejos prácticos** y mejores prácticas

Carga de Carpetas: Consolidando Reportes Mensuales
--------------------------------------------------

**Escenario Empresarial**: Una empresa minorista recibe reportes de ventas mensuales de 12 tiendas regionales. Cada tienda envía un archivo Excel con la misma estructura pero datos diferentes.

**Paso a Paso:**

1. **Prepara Tu Estructura de Datos**
   - Crea una carpeta: ``C:\Reportes\Ventas_Mensuales``
   - Cada archivo Excel tiene columnas: ``Fecha, ID_Tienda, Producto, Ventas, Cantidad``

   **Archivo de Muestra: tienda_norte_enero.xlsx**
   +------------+----------+---------+-------+----------+
   | Fecha      | ID_Tienda| Producto| Ventas| Cantidad |
   +============+==========+=========+=======+==========+
   | 2024-01-01 | NORTE_01 | Laptop | 1200  | 5        |
   | 2024-01-02 | NORTE_01 | Mouse  | 50    | 10       |
   +------------+----------+---------+-------+----------+

2. **Carga Múltiples Archivos**
   - Haz clic en **"Archivo"** → **"Cargar Carpeta..."**
   - Selecciona la carpeta ``Ventas_Mensuales``
   - Elige todos los archivos .xlsx
   - Configura alineación de columnas (automática)

3. **Resultado**: Dataset consolidado único con datos de 12 meses × todas las tiendas

**Beneficios Empresariales**:
- Elimina trabajo manual de copiar y pegar
- Reduce errores de consolidación manual
- Habilita flujos de trabajo automatizados de reportes mensuales

Uniones de Datos: Análisis de Clientes con Historial de Compras
--------------------------------------------------------------

**Escenario Empresarial**: El equipo de marketing necesita analizar comportamiento de clientes combinando demografía de clientes con historial de compras.

**Datasets de Ejemplo:**

**clientes.csv**:
+------------+-------------+--------+
| CustomerID | Name        | Region |
+============+=============+========+
| C001       | John Doe    | North  |
| C002       | Jane Smith  | South  |
+------------+-------------+--------+

**compras.csv**:
+------------+----------+-------+------------+
| CustomerID | Product  | Amount| Date       |
+============+==========+=======+============+
| C001       | Laptop   | 1200  | 2024-01-15 |
| C002       | Mouse    | 50    | 2024-01-16 |
+------------+----------+-------+------------+

**Proceso de Unión:**

1. Carga ``clientes.csv`` como dataset primario
2. Haz clic en **"Datos"** → **"Unir Datos..."**
3. Carga ``compras.csv`` como dataset secundario
4. Selecciona **Unión Interna** en ``CustomerID``
5. Resultado muestra detalles de cliente con sus compras

**Aplicaciones Empresariales**:
- Análisis de segmentación de clientes
- Identificación de patrones de compra
- Performance de ventas regional
- Cálculos de valor de vida del cliente

Exportaciones Separadas: Reportes Financieros Regionales
--------------------------------------------------------

**Escenario Empresarial**: El departamento financiero necesita generar archivos Excel individuales para cada departamento usando una plantilla estandarizada.

**Configuración de Plantilla**:

Crea ``plantilla_departamento.xlsx`` con:
- Encabezado de compañía y formato
- Placeholder de nombre de departamento
- Tabla de comparación Presupuesto vs Actual
- Gráficos para análisis visual

**Estructura de Datos**:
+------------+-------------+--------+--------+
| Department | Category    | Budget | Actual |
+============+=============+========+=======+
| Sales      | Revenue     | 50000  | 52000  |
| Sales      | Expenses    | 15000  | 14800  |
| Marketing  | Revenue     | 30000  | 28500  |
| Marketing  | Expenses    | 12000  | 11800  |
+------------+-------------+--------+--------+

**Proceso de Exportación:**

1. Carga datos financieros consolidados
2. Prepara plantilla Excel con formato
3. Haz clic en **"Separar"** → **"Exportar Datos Separados..."**
4. Selecciona ``Department`` como columna de separación
5. Mapea columnas de datos a posiciones de plantilla
6. Genera reportes individuales por departamento

**Beneficios Empresariales**:
- Formato consistente de reportes entre departamentos
- Distribución automatizada de reportes personalizados
- Ahorro de tiempo en generación de reportes
- Reducción de errores de formato

Tablas Pivote: Análisis de Performance de Ventas
------------------------------------------------

**Escenario Empresarial**: Gerente de ventas necesita analizar performance de productos entre regiones y períodos de tiempo.

**Dataset**: Datos de ventas mensuales con productos, regiones y períodos de tiempo.

**Creando un Pivote Comprehensive:**

1. Carga dataset de ventas
2. Haz clic en **"Datos"** → **"Tabla Pivote..."**
3. Configura estructura de pivote:

   - **Filas**: Región, Producto
   - **Columnas**: Mes
   - **Valores**: Suma de Ventas, Conteo de Transacciones
   - **Filtros**: Rango de Fechas

4. Agrega campos calculados (ej. Venta Promedio por Transacción)

**Características Avanzadas de Pivote:**

- **Drill-down**: Haz clic en celdas para ver transacciones detalladas
- **Agrupamiento**: Agrupar fechas por mes/trimestre/año
- **Consolidación Múltiple**: Mostrar suma y promedio
- **Formato Condicional**: Resaltar mejores/peores performers

**Información Empresarial Generada**:
- Mejores productos performing por región
- Tendencias estacionales de ventas
- Comparaciones de crecimiento regional
- Análisis de rentabilidad de productos

Operaciones Combinadas: Pipeline de Business Intelligence End-to-End
---------------------------------------------------------------------

**Escenario**: Generación mensual de reportes de business intelligence para una compañía manufacturera.

**Flujo Completo:**

1. **Recolección de Datos (Carga de Carpetas)**
   - Cargar datos de producción de múltiples ubicaciones de planta
   - Consolidar métricas de control de calidad
   - Importar datos de ventas e inventario

2. **Integración de Datos (Uniones)**
   - Unir datos de producción con métricas de calidad
   - Combinar con performance de ventas
   - Vincular con niveles de inventario

3. **Análisis (Tablas Pivote)**
   - Crear pivote de eficiencia de producción por planta
   - Analizar métricas de calidad por línea de producto
   - Generar performance de ventas por región

4. **Reportes (Exportaciones Separadas)**
   - Exportar reportes de performance de planta individuales
   - Generar dashboards de resumen ejecutivo
   - Crear archivos de análisis específicos por departamento

**Valor Empresarial**:
- Ciclo de reportes mensuales automatizado
- Metodología de análisis consistente
- Visibilidad en tiempo real en operaciones
- Toma de decisiones basada en datos

Optimización de Rendimiento
---------------------------

Manejo de Datasets Grandes
~~~~~~~~~~~~~~~~~~~~~~~~~~

- **Chunking**: Procesar datos en chunks manejables
- **Gestión de Memoria**: Uso eficiente de memoria
- **Indexación**: Indexación automática para operaciones rápidas
- **Almacenamiento en Caché**: Almacenar en caché resultados intermedios

Técnicas de Optimización
~~~~~~~~~~~~~~~~~~~~~~~~

- **Optimización de Tipos de Datos**: Usar tipos de datos apropiados
- **Selección de Columnas**: Trabajar solo con columnas necesarias
- **Filtrar Temprano**: Aplicar filtros antes de operaciones complejas
- **Procesamiento Paralelo**: Utilizar múltiples núcleos de CPU

Manejo de Errores y Recuperación
--------------------------------

Problemas Comunes
~~~~~~~~~~~~~~~~~

- **Errores de Memoria**: Para datasets muy grandes
- **Problemas de Permisos de Archivo**: Problemas de derechos de acceso
- **Conflictos de Tipos de Datos**: Tipos de columna incompatibles
- **Problemas de Formato de Plantilla**: Plantillas Excel inválidas

Opciones de Recuperación
~~~~~~~~~~~~~~~~~~~~~~~~

- **Recuperación Automática**: Reanudar operaciones interrumpidas
- **Resultados Parciales**: Guardar porciones completadas
- **Logging de Errores**: Información detallada de errores
- **Rollback**: Deshacer operaciones problemáticas

Mejores Prácticas
-----------------

Preparación de Datos
~~~~~~~~~~~~~~~~~~~~

- **Limpiar Datos**: Manejar valores faltantes y valores atípicos
- **Formatos Consistentes**: Estandarizar formatos de fecha y número
- **Validación**: Verificar integridad de datos antes de operaciones
- **Backup**: Mantener datos originales seguros

Planificación de Flujos de Trabajo
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- **Planificar Operaciones**: Diseñar flujo de trabajo antes de ejecución
- **Probar con Muestras**: Validar con muestras de datos pequeños
- **Monitorear Recursos**: Observar uso de memoria y disco
- **Documentar Procesos**: Registrar flujos de trabajo exitosos

Próximos Pasos
--------------

- :doc:`troubleshooting` - Soluciones para problemas de características avanzadas
- :doc:`getting_started` - Regresar a uso básico
- :doc:`../developer_guide/architecture` - Detalles de implementación técnica