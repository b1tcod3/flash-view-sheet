Guía de Instalación
==================

Esta guía proporciona instrucciones detalladas para instalar Flash Sheet en diferentes plataformas y entornos.

Método 1: Instalación desde PyPI
--------------------------------

Instalación Simple
~~~~~~~~~~~~~~~~~~

**Para usuarios finales:**

1. Asegurar que Python 3.7+ esté instalado
2. Instalar Flash Sheet desde PyPI:

   .. code-block:: bash

      pip install flash-sheet

3. Lanzar la aplicación:

   .. code-block:: bash

      flash-sheet

Método 2: Instalación desde Código Fuente
-----------------------------------------

Instalación de Desarrollo
~~~~~~~~~~~~~~~~~~~~~~~~~

**Para desarrolladores y usuarios avanzados:**

1. Clonar el repositorio:

   .. code-block:: bash

      git clone https://github.com/your-org/flash-sheet.git
      cd flash-sheet

2. Crear entorno virtual:

   .. code-block:: bash

      python -m venv venv
      source venv/bin/activate  # En Windows: venv\Scripts\activate

3. Instalar dependencias:

   .. code-block:: bash

      pip install -r requirements.txt

4. Ejecutar la aplicación:

   .. code-block:: bash

      python main.py

Método 3: Instalación con Conda
-------------------------------

Instalación con Conda
~~~~~~~~~~~~~~~~~~~~~

**Usando conda:**

1. Instalar Miniconda o Anaconda
2. Crear un nuevo entorno:

   .. code-block:: bash

      conda create -n flash-sheet python=3.8
      conda activate flash-sheet

3. Instalar Flash Sheet:

   .. code-block:: bash

      conda install -c your-channel flash-sheet

4. Lanzar la aplicación:

   .. code-block:: bash

      flash-sheet

Instrucciones Específicas de Plataforma
---------------------------------------

Instalación en Windows
~~~~~~~~~~~~~~~~~~~~~~

**Prerrequisitos:**

- Windows 10 o posterior
- Privilegios de administrador para instalación

**Pasos de Instalación:**

1. Descargar el instalador desde la página de releases
2. Hacer clic derecho en el instalador y seleccionar "Ejecutar como administrador"
3. Seguir el asistente de instalación:

   - Elegir directorio de instalación (predeterminado: C:\Program Files\Flash Sheet)
   - Seleccionar componentes a instalar
   - Crear acceso directo en escritorio (recomendado)

4. El instalador agregará Flash Sheet a tu PATH

**Desinstalación:**

- Usar Configuración de Windows → Aplicaciones → Flash Sheet → Desinstalar
- O ejecutar el desinstalador desde el directorio de instalación

Instalación en macOS
~~~~~~~~~~~~~~~~~~~~

**Prerrequisitos:**

- macOS 10.15 o posterior
- Gatekeeper puede necesitar configuración para aplicaciones sin firmar

**Pasos de Instalación:**

1. Descargar el archivo .dmg desde la página de releases
2. Hacer doble clic en el archivo .dmg para montarlo
3. Arrastrar Flash Sheet a la carpeta Aplicaciones
4. Expulsar la imagen de disco

**Primer Lanzamiento:**

macOS puede mostrar una advertencia de seguridad. Para permitir que Flash Sheet se ejecute:

1. Ir a Preferencias del Sistema → Seguridad y Privacidad
2. Hacer clic en el botón "Permitir" junto a Flash Sheet
3. Lanzar Flash Sheet desde Aplicaciones

**Desinstalación:**

- Arrastrar Flash Sheet desde Aplicaciones a la Papelera
- Vaciar la Papelera

Instalación en Linux
~~~~~~~~~~~~~~~~~~~~

**Ubuntu/Debian:**

1. Descargar el paquete .deb desde la página de releases
2. Instalar usando dpkg:

   .. code-block:: bash

      sudo dpkg -i flash-sheet.deb
      sudo apt-get install -f  # Corregir cualquier dependencia

3. Lanzar desde menú de aplicaciones o línea de comandos:

   .. code-block:: bash

      flash-sheet

**Fedora/CentOS:**

1. Descargar el paquete .rpm desde la página de releases
2. Instalar usando rpm:

   .. code-block:: bash

      sudo rpm -i flash-sheet.rpm

3. Lanzar la aplicación

**AppImage (Universal):**

1. Descargar el archivo AppImage
2. Hacerlo ejecutable y ejecutar:

   .. code-block:: bash

      chmod +x flash-sheet.AppImage
      ./flash-sheet.AppImage

**Desinstalación:**

- Para instalaciones empaquetadas: Usar el administrador de paquetes
- Para AppImage: Simplemente eliminar el archivo

Post-Instalación
----------------

Configuración Inicial
~~~~~~~~~~~~~~~~~~~~~

1. **Selección de Idioma**: Elegir idioma preferido
2. **Selección de Tema**: Elegir tema claro u oscuro
3. **Configuraciones Predeterminadas**: Configurar opciones de carga de datos predeterminadas
4. **Asociaciones de Archivo**: Asociar tipos de archivo con Flash Sheet (opcional)

Optimización de Performance
~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Configuraciones de Memoria:**

- Asignación de memoria predeterminada es automática
- Para datasets grandes, aumentar memoria disponible en configuraciones
- Cerrar otras aplicaciones al trabajar con datos grandes

**Configuraciones de Pantalla:**

- Usar escalado de DPI alto para pantallas de alta resolución
- Ajustar tamaños de fuente para legibilidad
- Habilitar aceleración de hardware si disponible

Directorio de Datos Predeterminado
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Ubicaciones Predeterminadas de Datos:**

- **Windows**: ``%APPDATA%\Flash Sheet``
- **macOS**: ``~/Library/Application Support/Flash Sheet``
- **Linux**: ``~/.config/flash-sheet``

**Directorio de Datos Personalizado:**

1. Crear una carpeta dedicada para tus datos
2. En configuraciones de Flash Sheet, establecer el directorio de datos predeterminado
3. Colocar plantillas y archivos de configuración allí

Solución de Problemas de Instalación
------------------------------------

Problemas de Instalación Comunes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Error "Python no encontrado":**

- Instalar Python 3.7+ desde python.org
- Agregar Python al PATH del sistema
- Reiniciar línea de comandos/terminal

**Permiso Denegado:**

- Ejecutar instalador como administrador (Windows)
- Usar sudo para instalación a nivel de sistema (Linux/macOS)
- Verificar permisos de carpeta

**Dependencias Faltantes:**

- Instalar paquetes de sistema requeridos
- Actualizar pip: ``pip install --upgrade pip``
- Usar entorno virtual para evitar conflictos

**Problemas de Qt/PySide6:**

- Instalar bibliotecas de desarrollo de Qt
- Actualizar controladores de gráficos
- Verificar configuración de servidor de pantalla (Linux)

**Antivirus Bloqueando:**

- Agregar Flash Sheet a exclusiones de antivirus
- Deshabilitar escaneo en tiempo real durante instalación
- Descargar desde fuentes oficiales únicamente

Verificación y Testing
~~~~~~~~~~~~~~~~~~~~~~

**Verificación de Instalación:**

1. Lanzar Flash Sheet
2. Verificar versión en Ayuda → Acerca de
3. Cargar un archivo CSV de muestra
4. Probar funcionalidad básica de exportación

**Testing de Performance:**

1. Cargar un dataset de muestra
2. Probar diferentes modos de vista
3. Intentar operaciones de exportación
4. Monitorear uso de memoria

Desinstalación
--------------

Eliminación Completa
~~~~~~~~~~~~~~~~~~~~

**Windows:**

1. Ir a Configuración → Aplicaciones → Flash Sheet
2. Hacer clic en "Desinstalar"
3. Eliminar datos de usuario si se desea:

   .. code-block:: batch

      rmdir /s "%APPDATA%\Flash Sheet"

**macOS:**

1. Arrastrar Flash Sheet desde Aplicaciones a la Papelera
2. Eliminar datos de usuario:

   .. code-block:: bash

      rm -rf ~/Library/Application\ Support/Flash\ Sheet

**Linux:**

1. Usar administrador de paquetes para desinstalar
2. Eliminar datos de usuario:

   .. code-block:: bash

      rm -rf ~/.config/flash-sheet

Actualización de Flash Sheet
----------------------------

Actualizaciones Automáticas
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Flash Sheet puede verificar actualizaciones automáticamente:

1. Ir a Ayuda → Verificar Actualizaciones
2. Descargar e instalar actualizaciones disponibles
3. Reiniciar la aplicación

Actualizaciones Manuales
~~~~~~~~~~~~~~~~~~~~~~~~

1. Descargar nueva versión desde página de releases
2. Cerrar Flash Sheet
3. Ejecutar instalador para nueva versión
4. El instalador actualizará tu instalación existente

**Desde Código Fuente:**

.. code-block:: bash

   cd flash-sheet
   git pull origin main
   pip install -r requirements.txt
   python main.py

Backup Antes de Actualizar
~~~~~~~~~~~~~~~~~~~~~~~~~~

- Exportar datos importantes
- Hacer backup de archivos de configuración
- Notar configuraciones personalizadas
- Guardar archivos de proyecto

Uso desde Línea de Comandos
---------------------------

Opciones Avanzadas de Instalación
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Instalación Silenciosa (Windows):**

.. code-block:: batch

   flash-sheet-setup.exe /S /D=C:\Program Files\Flash Sheet

**Directorio de Instalación Personalizado:**

.. code-block:: bash

   # Linux/macOS
   export FLASH_SHEET_HOME=/opt/flash-sheet
   pip install --target=$FLASH_SHEET_HOME flash-sheet

**Instalación de Desarrollo:**

.. code-block:: bash

   pip install -e .  # Instalación editable para desarrollo

Variables de Entorno
~~~~~~~~~~~~~~~~~~~~

**Configuración vía Entorno:**

.. code-block:: bash

   export FLASH_SHEET_CONFIG_DIR=~/.flash-sheet
   export FLASH_SHEET_LOG_LEVEL=DEBUG
   export FLASH_SHEET_MAX_MEMORY=4GB

**Configuración de Ruta de Python:**

.. code-block:: bash

   export PYTHONPATH=$PYTHONPATH:/path/to/flash-sheet

Instalación en Red
------------------

Deployment Empresarial
~~~~~~~~~~~~~~~~~~~~~~

**Política de Grupo de Windows:**

1. Crear punto de distribución de software
2. Usar instalador MSI para deployment de política de grupo
3. Configurar configuraciones de instalación vía GPO

**Gestión de Paquetes Linux:**

1. Crear repositorio de paquetes interno
2. Distribuir paquetes .deb/.rpm
3. Usar herramientas de gestión de configuración (Ansible, Puppet)

**MDM de macOS:**

1. Usar soluciones de dispositivo móvil management
2. Deploy vía perfil MDM
3. Configurar políticas de seguridad

Instalación Offline
~~~~~~~~~~~~~~~~~~~

**Sistemas Air-Gapped:**

1. Descargar todas las dependencias en sistema conectado
2. Transferir archivos a sistema offline
3. Instalar usando caché de paquete local:

   .. code-block:: bash

      pip install --no-index --find-links=/path/to/packages flash-sheet

Ayuda de Instalación
--------------------

Soporte de Instalación
~~~~~~~~~~~~~~~~~~~~~~

- **Documentación**: Verificar sección de solución de problemas
- **Rastreador de Problemas**: Reportar problemas de instalación
- **Foro Comunitario**: Hacer preguntas de instalación
- **Soporte por Email**: contact@flash-sheet.org

Compatibilidad del Sistema
~~~~~~~~~~~~~~~~~~~~~~~~~~

**Plataformas Probadas:**

- Windows 10, 11
- macOS 10.15 - 12.x
- Ubuntu 18.04 - 22.04
- CentOS 7, 8
- Fedora 34+

**Limitaciones Conocidas:**

- Procesadores ARM: Soporte limitado
- Wayland (Linux): Puede requerir fallback a X11
- Controladores de gráficos antiguos: Pueden necesitar actualizaciones

Próximos Pasos
--------------

Después de instalación exitosa:

1. :doc:`../user_guide/getting_started` - Aprender lo básico
2. :doc:`../user_guide/basic_usage` - Comenzar a usar Flash Sheet
3. :doc:`../user_guide/advanced_features` - Explorar características avanzadas
4. :doc:`../developer_guide/development_guide` - Para desarrolladores